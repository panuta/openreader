{% extends 'base_authenticated.html' %}
{% load helper_tags pagination_tags %}

{% block topnav %}{% include 'snippets/organization_topnav.html' with active_menu='user' %}{% endblock %}

{% block organization_manage_head_title %} - ผู้ใช้งาน{% endblock %}
{% block organization_manage_sidebar %}{% include 'accounts/manage/snippets/organization_sidebar.html' with active_manage_menu='user' %}{% endblock %}

{% block body_authenticated %}
<div class="container-fluid organization_profile_page"><div class="row-fluid">
    <div class="content"><div class="inner-content">
        <h2>การจัดการผู้ใช้</h2>

        <ul class="nav nav-tabs">
            <li class="active"><a href="#">รายชื่อผู้ใช้</a></li>
            <li><a href="#">กลุ่มผู้ใช้</li>
        </ul>

        {% can user 'manage_user' organization %}
        <div class="page_actions">
          <a href="{% url invite_organization_user organization.slug %}" class="btn"><i class="icon-user"></i> เพิ่มผู้ใช้ระบบ</a>
          <!--<a href="{% url invite_organization_user organization.slug %}" class="btn"><i class="icon-file"></i> เพิ่มผู้ใช้จากไฟล์ CSV</a>-->
        </div>

        <ul class="nav nav-tabs">
          <li class="active"><a href="{% url view_organization_users organization.slug %}">ผู้ใช้ทั้งหมด ({% print_users_count organization %})</a></li>
          <li><a href="{% url view_organization_invited_users organization.slug %}">คำขอเพิ่มผู้ใช้ ({% print_user_invitation_count organization %})</a></li>
        </ul>
        {% endcan %}

        {% autopaginate organization_users 50 %}
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>ชื่อ</th>
              <th>อีเมล</th>
              {% can user 'manage_user' organization %}<th class="edit_column"></th>{% endcan %}
            </tr>
          </thead>
          <tbody>
            {% for organization_user in organization_users %}
            <tr>
              <td>{{organization_user.user.get_profile.get_fullname}}</td>
              <td>{{organization_user.user.email}}</td>
              {% can user 'manage_user' organization %}<td class="row_actions"><a href="{% url edit_organization_user organization_user.id %}" class="btn btn-small">แก้ไข</a></td>{% endcan %}
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% paginate %}

    </div></div>
</div></div>
{% endblock %}