{% extends 'base_authenticated.html' %}
{% load helper_tags pagination_tags document_tags %}

{% block head_title %}ไฟล์เอกสาร{% endblock %}
{% block topnav %}{% include 'snippets/organization_topnav.html' with active_menu='document' %}{% endblock %}

{% block body_authenticated %}
{% autopaginate publications 50 %}

<div class="container-fluid container-body documents_page">
{% include 'document/snippets/documents_sidebar.html' %}

<div class="content"><div class="content-inner">
  <h2>{% if shelf_type == 'all' %}ไฟล์ทั้งหมด{% endif %}{% if shelf_type == 'none' %}ไฟล์ที่ไม่อยู่ในชั้นหนังสือ{% endif %}{% if shelf %}<span>ชั้นหนังสือ</span>{{shelf.name}}{% endif %}</h2>

  {% if shelf %}
    <div class="page_actions">
      {% can user 'upload_shelf' organization=organization shelf=shelf %}<a href="{% url upload_documents_to_shelf organization.slug shelf.id %}" class="btn primary upload_publication_button"><span>อัพโหลดไฟล์เข้าชั้นหนังสือ</span></a>{% endcan %}
      {% can user 'admin' organization=organization %}<a href="{% url edit_document_shelf organization.slug shelf.id %}" class="btn edit_shelf_button"><span>แก้ไขชั้นหนังสือ</span></a>{% endcan %}
    </div>
  {% endif %}

  <ul id="upload_errors"></ul>
  <ul id="upload_jobs"></ul>

  <table class="publications_table" {% if not publications %}style="display:none;"{% endif %}>
    <colgroup>
      <col width=""/>
      <col width="155"/>
    </colgroup>
    
    <tbody>
      {% for publication in publications %}
      <tr id="{{publication.uid}}">
        <td class="name">
          <div><a href="{% url view_document publication.uid %}">{{publication.title}}</a></div>
          <div class="uploaded">อัพโหลดเมื่อ {{publication.uploaded|format_abbr_datetime}}</div>
        </td>
        <td class="table_actions">
          <a href="{% url edit_document publication.uid %}" class="small btn" >แก้ไข</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% paginate %}

  {% if not publications %}
  <div class="no_row">ไม่มีไฟล์</div>
  {% endif %}

</div></div>
</div>

<div class="modal hide fade" id="upload-document-modal" style="display:none;">
  <div class="modal-header"><a class="close" href="#">×</a><h3>อัพโหลดไฟล์ไปที่ <em>ชั้นหนังสือธรรมดา</em></h3></div>
  <div class="modal-message"></div>
  <div class="modal-body">
    <div class="upload_dropzone" id="upload_dropzone"><a href="#" class="btn select_files_button" id="select_files_button"><span>เลือกไฟล์</span></a></div>
  </div>
</div>


{% endblock %}